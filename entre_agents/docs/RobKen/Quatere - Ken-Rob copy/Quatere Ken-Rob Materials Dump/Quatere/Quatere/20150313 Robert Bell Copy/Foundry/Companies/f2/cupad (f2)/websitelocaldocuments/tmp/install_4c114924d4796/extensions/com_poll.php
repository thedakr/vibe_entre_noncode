<?php/** @package		AceSEF* @subpackage	Polls* @copyright	2009 JoomAce LLC, www.joomace.net* @license		GNU/GPL*/// No Permissiondefined('_JEXEC') or die('Restricted access');class AceSEF_com_poll extends AceSEFTools {	var $params;	var $title_poll;		function getPollTitle($id) {		$joomfish = $this->sef_config->joomfish_trans_url ? ', id' : '';		        $database =& JFactory::getDBO();        $database->setQuery("SELECT title, alias$joomfish FROM #__polls WHERE id =".$id);        $rows = $database->loadRow();				$name = (($this->params->get('pollid_inc', '1') != '1') ? $id.'-' : '');		if($this->params->get('poll_part', 'title') == 'title')			$name .= $rows[0];		else			$name .= $rows[1];				$this->title_poll = $rows[0];					return $name;    }		function buildRoute(&$uri) {		$vars = $uri->getQuery(true);        extract($vars);		$title = array();				$this->params = AceSEFTools::getExtParams('com_poll');				static $items;		if(!empty($id))			$title[] = $this->getPollTitle($id);		return $title;	}		function metaTags(&$uri) {		$vars = $uri->getQuery(true);        extract($vars);		$meta = array();		$config =& JFactory::getConfig();				$enable_title		= $this->params->get('enable_title', '2');		$enable_desc		= $this->params->get('enable_desc', '2');		$enable_key			= $this->params->get('enable_key', '2');		$separator			= $this->params->get('separator', '-');		$sitename			= $config->getValue('sitename');		$custom_sitename	= $this->params->get('custom_sitename', '');		$use_sitename		= $this->params->get('use_sitename', '2');		$title_prefix		= $this->params->get('title_prefix', '');		$title_suffix		= $this->params->get('title_suffix', '');		$desc_length		= $this->params->get('desc_length', '250');		$keywords_word		= $this->params->get('keywords_word', '3');		$keywords_count		= $this->params->get('keywords_count', '15');		$blacklist			= $this->params->get('blacklist', '');				$title = $desc = "";				if (isset($view)){			switch ($view){				case 'poll': 					if(isset($id)){						$title	= $this->title_poll;						$desc	= AceSEFTools::cleanDesc($this->title_poll);					}					break;			}		}				// Set meta tags		if($enable_title == 2 && !empty($title)){			// Prepare meta title						if(!empty($custom_sitename))				$sitename = $custom_sitename;						if($use_sitename == 1)				$title = $sitename." ".$separator." ".$title;			elseif ($use_sitename == 2)				$title = $title." ".$separator." ".$sitename;							if(!empty($title_prefix))				$title = $title_prefix." ".$separator." ".$title;							if(!empty($title_suffix))				$title = $title." ".$separator." ".$title_suffix;						$meta['metatitle']	= $title;		}					if($enable_title == 2 && !empty($title))			$meta['metatitle']	= $title;		if($enable_desc == 2 && !empty($desc))			$meta['metadesc']	= AceSEFTools::clipDesc($desc, $desc_length);		if($enable_key == 2 && !empty($desc))			$meta['metakey']	= AceSEFTools::generateKeywords($desc, $blacklist, $keywords_count, $keywords_word);		return $meta;	}}?>