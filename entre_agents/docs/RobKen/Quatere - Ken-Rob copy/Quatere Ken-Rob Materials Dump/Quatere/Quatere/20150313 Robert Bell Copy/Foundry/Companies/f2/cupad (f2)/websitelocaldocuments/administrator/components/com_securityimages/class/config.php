<?php/** **************************************************************** * This file is part of SecurityImages for Joomla!. * * SecurityImages is free software: you can redistribute it and/or modify * it under the terms of the GNU General Public License as published by * the Free Software Foundation, either version 3 of the License, or * any later version. * Foobar is distributed in the hope that it will be useful, * but WITHOUT ANY WARRANTY; without even the implied warranty of * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the * GNU General Public License for more details. * * You should have received a copy of the GNU General Public License * along with Foobar.  If not, see <http://www.gnu.org/licenses/>. * * @package		SecurityImages * @copyright	Copyright (C) 2004 - 2008 Cédric Walter. All rights reserved. *******************************************************************/defined( '_JEXEC' ) or die( 'Restricted access' );class SecurityImagesConfig extends JObject{  /**   * Enter description here...   *   * @return SecurityImagesConfig   */  function SecurityImagesConfig()  {  }  function getContentOfFile($file, $option) {    //change all single backslashes to double backslashes, because of eventual windows path    //str_replace('\\','\\\\', $file);    //$file = stripslashes($file);    $f = fopen($file, "r");    $content = fread($f, filesize($file));    return $content;  }  function showFile($file, $option) {    //change all single backslashes to double backslashes, because of eventual windows path    //str_replace('\\','\\\\', $file);    //$file = stripslashes($file);    $f = fopen($file, "r");    $content = fread($f, filesize($file));    $content = htmlspecialchars($content);    ?><form action="index2.php?" method="post" name="adminForm"	class="adminForm" id="adminForm"><table cellpadding="4" cellspacing="0" border="0" width="100%"	class="adminform">	<tr>		<th colspan="4">Path: <?php echo $file; ?></th>	</tr>	<tr>		<td><textarea cols="180" rows="40" name="filecontent" id="filecontent"><?php echo $content; ?></textarea>		</td>	</tr>	<tr>		<td class="error">Please note: The file must be writable to save your		changes.</td>	</tr></table><input type="hidden" name="file" value="<?php echo $file; ?>" /> <input	type="hidden" name="option" value="<?php echo $option; ?>"> <input	type="hidden" name="task" value=""> <input type="hidden"	name="boxchecked" value="0"></form>    <?php}/** * Enter description here... * * @param unknown_type $option */function showGeneralConfig($option){  include (JPATH_SITE.DS.'administrator'.DS.'components'.DS.'com_securityimages'.DS.'config.securityimages.php');    ?><script language="javascript" type="text/javascript">	    function submitbutton(pressbutton) {	      var form = document.adminForm;	      if (pressbutton == 'cancel') {	        submitform( pressbutton );	        return;	      }	        submitform( pressbutton );	    }	    </script><table cellpadding="0" cellspacing="0" border="0">	<tr>		<td><img			src=<?php echo JURI :: root()."/administrator/components/com_securityimages/logo/com_securityimages.png" ?>>		</td>		<td><b><?php echo JText::_('SECURITY IMAGES ABOUT TITLE'); ?></b> <br>		<br>		<?php		echo JText::_('SECURITY IMAGES DESCRIPTION');		$copyright = "<p></br>" . "" . "</br>" . "" . "</br></br></br>" . "<font class='smalldark'><b>" . $securityImagesVersion . "</b> - Copyright 2005 by Walter Cedric - " . $securityImagesLink . "</font></p>";		echo $copyright;		?></td>	</tr></table><br /><form action="index2.php" method="post" name="adminForm"><br />		<?php		jimport('joomla.html.pane');		$jPaneTabs =& JPane::getInstance('sliders');		echo $jPaneTabs->startPane("SecuritY Images");		echo $jPaneTabs->startPanel(JText::_('SECURITY IMAGES PLUGIN TAB'), "General-Settings");		?><div class="col40"><fieldset class="adminform"><table border="0" cellpadding="4" cellspacing="2" class="adminForm">	<tr align="left" valign="middle">		<td align="left" valign="top">&nbsp;</td>		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES USE CORE HELP'); ?></strong></td>		<td align="left" valign="top">&nbsp;</td>	</tr></table><table border="1" cellpadding="4" cellspacing="2" class="adminForm">	<tr align="left" valign="middle">		<td align="left" valign="middle"><img			src=<?php echo JURI :: root()."/administrator/components/com_securityimages/logo/core1.1.png" ?>></td>		<td align="left" valign="middle"><img			src=<?php echo JURI :: root()."/administrator/components/com_securityimages/logo/freecap1.4.png"?>></td>		<td align="left" valign="middle"><img			src=<?php echo JURI :: root()."/administrator/components/com_securityimages/logo/hncaptha1.0.jpg"?>></td>	</tr>	<tr align="left" valign="middle">		<td align="left" valign="top">core v1.1</td>		<td align="left" valign="top">freecap v1.4</td>		<td align="left" valign="top">hncaptcha v1.0</td>	</tr>	<tr align="left" valign="middle">		<td align="left" valign="middle"><img			src=<?php echo JURI :: root()."/administrator/components/com_securityimages/logo/watercap.png" ?>></td>		<td align="left" valign="middle"><img			src=<?php echo JURI :: root()."/administrator/components/com_securityimages/logo/calculator.jpg"?>></td>		<td align="left" valign="middle">&nbsp;</td>	</tr>	<tr align="left" valign="middle">		<td align="left" valign="top">watercap v1.0</td>		<td align="left" valign="top">calculator v1.0</td>		<td align="left" valign="middle">recaptcha v1.10</td>	</tr></table><br /><table width="100%" border="0" cellpadding="4" cellspacing="2"	class="adminForm">	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES USE CORE S') ?></strong></td>		<td align="left" valign="top"><?php		$soutput[] = JHTML::_('select.option', 'core', 'core');		$soutput[] = JHTML::_('select.option', 'freecap', 'freecap');		$soutput[] = JHTML::_('select.option', 'hncaptcha', 'hncaptcha');		$soutput[] = JHTML::_('select.option', 'calculator', 'calculator');		$soutput[] = JHTML::_('select.option', 'watercap', 'watercap');		$soutput[] = JHTML::_('select.option', 'recaptcha', 'recaptcha');		$_output = JHTML::_('select.genericlist', $soutput, 'securityImagesPlugins', 'class="inputbox" size="6"', 'value', 'text', $securityImagesPlugins);		echo $_output;		?></td>		<td align="left" valign="top"><?php echo JText::_('SECURITY IMAGES USE CORE L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES USE CORE VERSION S') ?></strong></td>		<td align="left" valign="top"><?php		$soutput1[] = JHTML::_('select.option', '1.0', '1.0');		$soutput1[] = JHTML::_('select.option', '1.1', '1.1');		$soutput1[] = JHTML::_('select.option', '1.2', '1.2');		$soutput1[] = JHTML::_('select.option', '1.3', '1.3');		$soutput1[] = JHTML::_('select.option', '1.4', '1.4');		$soutput1[] = JHTML::_('select.option', '1.10', '1.10');		$_output1 = JHTML::_('select.genericlist', $soutput1, 'securityImagesPluginsVersion', 'class="inputbox" size="6"', 'value', 'text', $securityImagesPluginsVersion);		echo $_output1;		?></td>		<td align="left" valign="top"><?php echo JText::_('SECURITY IMAGES USE CORE VERSION L') ?></td>	</tr></table><?php echo $jPaneTabs->endPanel(); ?> <?php echo $jPaneTabs->startPanel(JText::_('SECURITY IMAGES JOOMLA TAB'),"Joomla-core-patches-page"); ?><table width="100%" border="0" cellpadding="4" cellspacing="2"	class="adminForm">	<tr align="center" valign="middle">		<td align="left" valign="top"></td>		<td align="left" valign="top"><?php echo JText::_('SECURITY IMAGES PATCHES MANUAL L') ?></td>		<td align="left" valign="top" width="50%"></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES USE CORE LOGIN PATCHES S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist',  'securityImagesInLogin', 'class="inputbox"', $securityImagesInLogin ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES USE CORE LOGIN PATCHES L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES USE MOD LOGIN PATCHES S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist',  'securityImagesInLoginModule', 'class="inputbox"', $securityImagesInLoginModule ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES USE MOD LOGIN PATCHES L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES USE CORE SAVE REG PATCHES S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist',  'securityImagesInRegister', 'class="inputbox"', $securityImagesInRegister ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES USE CORE SAVE REG PATCHES L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES USE CORE SEND NEW PASS PATCHES S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist',  'securityImagesInResetPassword', 'class="inputbox"', $securityImagesInResetPassword ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES USE CORE SEND NEW PASS PATCHES L') ?></td>	</tr>		<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY_IMAGES_CONFIRM_RESET_S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist',  'securityImagesInConfirmResetPassword', 'class="inputbox"', $securityImagesInConfirmResetPassword ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY_IMAGES_CONFIRM_RESET_L') ?></td>	</tr>		<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY_IMAGES_COMPLETE_RESET_S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist',  'securityImagesInCompleteResetPassword', 'class="inputbox"', $securityImagesInCompleteResetPassword ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY_IMAGES_COMPLETE_RESET_L') ?></td>	</tr>			<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY_IMAGES_REMINDME_S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist',  'securityImagesInRemindMe', 'class="inputbox"', $securityImagesInRemindMe ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY_IMAGES_REMINDME_L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES USE CORE CONTACT PATCHES S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist',  'securityImagesInContact', 'class="inputbox"', $securityImagesInContact ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES USE CORE CONTACT PATCHES L') ?></td>	</tr></table><?php echo $jPaneTabs->endPanel(); ?> <?php echo $jPaneTabs->startPanel(JText::_('SECURITY IMAGES GENERAL TAB'),"General-page"); ?><table width="100%" border="0" cellpadding="4" cellspacing="2"	class="adminForm">	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES DISPLAY AUTHOR BACKLINK S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist',  'securityImagesDisplayAuthorBacklink', 'class="inputbox"', $securityImagesDisplayAuthorBacklink ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES DISPLAY AUTHOR BACKLINK L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES LOGGEDIN USER SWITCHOFF S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist', 'securityImagesLoggedInUserSwitchOff', 'class="inputbox"', $securityImagesLoggedInUserSwitchOff ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES LOGGEDIN USER SWITCHOFF L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES GENERAL SWITCH S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist', 'securitySwitchOffGlobally', 'class="inputbox"', $securitySwitchOffGlobally ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES GENERAL SWITCH L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES REGRESSION S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist', 'securityImagesRegressionTestMode', 'class="inputbox"', $securityImagesRegressionTestMode ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES REGRESSION L') ?></td>	</tr>					<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES GENERAL DEBUG S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist', 'securityImagesDebug', 'class="inputbox"', $securityImagesDebug ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES GENERAL DEBUG L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES GENERAL DEACTIVATE RELOAD BUTTON S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist', 'securityImagesDeactivateReloadButton', 'class="inputbox"', $securityImagesDeactivateReloadButton ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES GENERAL DEACTIVATE RELOAD BUTTON L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES GENERAL DEACTIVATE SOUND BUTTON S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist', 'securityImagesDeactivateSoundButton', 'class="inputbox"', $securityImagesDeactivateSoundButton ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES GENERAL DEACTIVATE SOUND BUTTON L') ?></td>	</tr></table><?php echo $jPaneTabs->endPanel(); ?> <?php echo $jPaneTabs->startPanel(JText::_('SECURITY IMAGES LOGGING TAB'),"Logging-page"); ?><table width="100%" border="0" cellpadding="4" cellspacing="2"	class="adminForm">	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES LOGGING SPAM S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist', 'securityImagesLogActive', 'class="inputbox"', $securityImagesLogActive ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES LOGGING SPAM L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES LOGGING LOGALL S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist', 'securityImagesLogAll', 'class="inputbox"', $securityImagesLogAll ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES LOGGING LOGALL L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES LOGGING NOTIFY ADMIN S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist', 'securityImagesNotifyAdmin', 'class="inputbox"', $securityImagesNotifyAdmin ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES LOGGING NOTIFY ADMIN L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES LOGGING MAXLOGSIZE S') ?></strong></td>		<td align="left" valign="top"><input type="text" size="45"			name="securityImagesLogSize"			value="<?php echo "$securityImagesLogSize"; ?>"></td>		<td align="left" valign="top"><?php echo JText::_('SECURITY IMAGES LOGGING MAXLOGSIZE L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES LOGGING ADMINEMAIL S') ?></strong></td>		<td align="left" valign="top"><input type="text" size="45"			name="securityImagesAdminEmail"			value="<?php echo "$securityImagesAdminEmail"; ?>"></td>		<td align="left" valign="top"><?php echo JText::_('SECURITY IMAGES LOGGING ADMINEMAIL L') ?></td>	</tr></table><?php echo $jPaneTabs->endPanel(); ?> <?phpecho $jPaneTabs->endPanel();?> <input type="hidden" name="option" value="<?php echo $option; ?>"> <input	type="hidden" name="task" value=""> <input type="hidden"	name="boxchecked" value="0">		</fieldset></div></form><?php}/** * * @authors Walter Cedric */function saveGeneralConfig($option, $securityImagesPlugins,$securityImagesPluginsVersion, $securitySwitchOffGlobally,$securityImagesDebug, $securityImagesUseInLogin,$securityImagesUseInRegistration, $securityImagesUseInSendNewPass,$securityImagesDeactivateReloadButton, $securityImagesDeactivateSoundButton,$securityImagesLogActive, $securityImagesLogAll,$securityImagesNotifyAdmin, $securityImagesLogSize,$securityImagesAdminEmail, $securityImagesLoggedInUserSwitchOff,$securityImagesDisplayAuthorBacklink, $securityImagesRegressionTestMode,$securityImagesInLogin,$securityImagesInLoginModule, $securityImagesInRegister, $securityImagesInResetPassword,$securityImagesInRemindMe, $securityImagesInContact,$securityImagesInConfirmResetPassword, $securityImagesInCompleteResetPassword){  global $mainframe;  require_once (dirname( __FILE__ ).DS.'SecurityImagesHelper.php');      //You are  not allowed to modify this copyright, keep the copyright, add yourself in it  $securityImagesVersionShort = "5.1.2";  $securityImagesVersion = "SecurityImage ".$securityImagesVersionShort;  $securityImagesLink = "<a href='http://www.waltercedric.com' target='blank' alt='Walter Cedric Home' title='Walter Cedric Home'>".$securityImagesVersion."</a>";  $configfile = JPATH_SITE.DS."administrator".DS."components".DS."com_securityimages".DS."config.securityimages.php";  error_log("*****" .$configfile);  @ chmod($configfile, 0766);  $permission = is_writable($configfile);  $mosmsg = "Config file not writeable!";  if (!$permission)  {    $mainframe->redirect("index2.php?option=$option&act=config", $mosmsg);    break;  }  $SecurityImagesHelper = & new SecurityImagesHelper();    $config = "<?php\n";    $config .= "// no direct access\n";  $config .= "defined('_JEXEC') or die( 'Restricted access' );\n";  $config .= "\n";  $config .= $SecurityImagesHelper->getMainCopyright($securityImagesVersion, $securityImagesLink);  $config .= "\n";  $config .= "\$securityImagesPlugins = \"$securityImagesPlugins\";\n";  $config .= "\$securityImagesPluginsVersion = \"$securityImagesPluginsVersion\";\n";  $config .= "\$securitySwitchOffGlobally = \"$securitySwitchOffGlobally\";\n";  $config .= "\$securityImagesDebug = \"$securityImagesDebug\";\n";  $config .= "\$securityImagesLoggedInUserSwitchOff = \"$securityImagesLoggedInUserSwitchOff\";\n";  $config .= "\$securityImagesUseInLogin = \"$securityImagesUseInLogin\";\n";  $config .= "\$securityImagesUseInRegistration = \"$securityImagesUseInRegistration\";\n";  $config .= "\$securityImagesUseInSendNewPass = \"$securityImagesUseInSendNewPass\";\n";  $config .= "\$securityImagesDeactivateReloadButton = \"$securityImagesDeactivateReloadButton\";\n";  $config .= "\$securityImagesDeactivateSoundButton = \"$securityImagesDeactivateSoundButton\";\n";  $config .= "\$securityImagesLogActive = \"$securityImagesLogActive\";\n";  $config .= "\$securityImagesLogAll = \"$securityImagesLogAll\";\n";  $config .= "\$securityImagesNotifyAdmin = \"$securityImagesNotifyAdmin\";\n";  $config .= "\$securityImagesLogSize = \"$securityImagesLogSize\";\n";  $config .= "\$securityImagesAdminEmail = \"$securityImagesAdminEmail\";\n";    $config .= "\$securityImagesInLogin = \"$securityImagesInLogin\";\n";  $config .= "\$securityImagesInLoginModule = \"$securityImagesInLoginModule\";\n";    $config .= "\$securityImagesInRegister = \"$securityImagesInRegister\";\n";  $config .= "\$securityImagesInResetPassword = \"$securityImagesInResetPassword\";\n";  $config .= "\$securityImagesInRemindMe = \"$securityImagesInRemindMe\";\n";  $config .= "\$securityImagesInContact = \"$securityImagesInContact\";\n";  $config .= "\$securityImagesInConfirmResetPassword = \"$securityImagesInConfirmResetPassword\";\n";  $config .= "\$securityImagesInCompleteResetPassword = \"$securityImagesInCompleteResetPassword\";\n";   $config .= "//You are  not allowed to modify this copyright\n";  $config .= "\$securityImagesVersion = \"$securityImagesVersion\";\n";  $config .= "\$securityImagesVersionShort = \"$securityImagesVersionShort\";\n";  $config .= "\$securityImagesLink = \"$securityImagesLink\";\n";  $config .= "\$securityImagesDisplayAuthorBacklink = \"$securityImagesDisplayAuthorBacklink\";\n";  $config .$config .= "\$securityImagesRegressionTestMode = \"$securityImagesRegressionTestMode\";\n";  $config .= "?>";  $mosmsg = "Config file open";  if ($fp = fopen("$configfile", "w"))  {    fputs($fp, $config, strlen($config));    fclose($fp);    $mosmsg = "Config file open and close";  }  $mainframe->redirect("index2.php?option=$option&task=general_settings", "Settings saved in " . $configfile);}}?>