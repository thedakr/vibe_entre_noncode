<?php/** **************************************************************** * This file is part of SecurityImages for Joomla!. * * SecurityImages is free software: you can redistribute it and/or modify * it under the terms of the GNU General Public License as published by * the Free Software Foundation, either version 3 of the License, or * any later version. * Foobar is distributed in the hope that it will be useful, * but WITHOUT ANY WARRANTY; without even the implied warranty of * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the * GNU General Public License for more details. * * You should have received a copy of the GNU General Public License * along with Foobar.  If not, see <http://www.gnu.org/licenses/>. * * @package		SecurityImages * @copyright	Copyright (C) 2004 - 2008 Cédric Walter. All rights reserved. *******************************************************************/defined( '_JEXEC' ) or die( 'Restricted access' );function savePluginSettings($option) {  $params_request = array (			'si_calculator_firstNumberMin',			'si_calculator_firstNumberMax',			'si_calculator_secondNumberMin',			'si_calculator_secondNumberMax',			'si_calculator_phpSessionInternalName',			'si_calculator_secretKey',			'si_calculator_securityImagesoutput',			'si_calculator_RGBmin',			'si_calculator_RGBmax',			'si_calculator_xSize',			'si_calculator_ySize',			'si_calculator_fontSize',			'si_calculator_useRandomBackground',			'si_calculator_BKG_RGBmin',			'si_calculator_BKG_RGBmax'			);			foreach ($params_request as $val)			{			  $$val = JRequest::getVar( $val, '');			}			saveConfig($option, $si_calculator_firstNumberMin, $si_calculator_firstNumberMax, 			$si_calculator_secondNumberMin, $si_calculator_secondNumberMax, 			$si_calculator_phpSessionInternalName, $si_calculator_secretKey, 			$si_calculator_securityImagesoutput, $si_calculator_RGBmin, 			$si_calculator_RGBmax, $si_calculator_xSize, $si_calculator_ySize, 			$si_calculator_fontSize, $si_calculator_useRandomBackground, 			$si_calculator_BKG_RGBmax, $si_calculator_BKG_RGBmin);}function displayRadioButtonChoice($shortText, $longText, $variableName, $variable){  ?><tr align='center' valign='middle'>	<td align='left' valign='top'><strong><?php echo JText::_($shortText) ?></strong></td>	<td align='left' valign='top' nowrap><?php  echo JHTML::_('select.booleanlist',$variableName, 'class="inputbox"', $variable); ?>	</td>	<td align='left' valign='top'><?php echo JText::_($longText) ?></td></tr>  <?php}function displayInputBoxChoice($shortText, $longText, $variableName, $variable){  ?><tr align="center" valign="middle">	<td align="left" valign="top"><strong><?php echo JText::_($shortText) ?></strong></td>	<td align="left" valign="top"><input type="text"		name="<?php echo "$variableName"?>" value="<?php echo "$variable"; ?>"></td>	<td align="left" valign="top"><?php echo JText::_($longText) ?></td></tr>  <?php}function showConfig($option){  global $securityImagesVersion, $securityImagesLink;  $copyright = "<p></br>" . "" . "</br>" . "" . "</br></br></br>" . "<font class='smalldark'><b>" . $securityImagesVersion . "</b> - Copyright 2005 by Walter Cedric - " . $securityImagesLink . "</font></p>";  require_once (JPATH_SITE. '/administrator/components/com_securityimages/pluginsA/calculator/1.0/config.php');  $database = & JFactory::getDBO();  ?><script language="javascript" type="text/javascript">    function submitbutton(pressbutton) {      var form = document.adminForm;      if (pressbutton == 'cancel') {        submitform( pressbutton );        return;      }        submitform( pressbutton );    }        var previewWindow = null;	function openPreviewWindow(){		var url ="<?php	global $securityImagesPlugins, $securityImagesPluginsVersion;	echo JURL_SITE."/components/com_securityimages/plugins/$securityImagesPlugins/$securityImagesPluginsVersion/imageGenerator.php\";";?>		if ((!previewWindow) || (previewWindow)) {			previewWindow = this.open(url, "", "dependent=yes,top=140,left=140,toolbar=no,menubar=no,status=no,location=no,scrollbars=yes,resizable=yes,width=230,height=35");		}		else {			previewWindow.focus()		}    }    </script><table cellpadding="0" cellspacing="0" border="0">	<tr>		<td><img			src=<?php echo JURI :: root()."/administrator/components/com_securityimages/logo/com_securityimages.png" ?>>		</td>		<td><b><?php echo JText::_('SECURITY IMAGES ABOUT TITLE') ?></b> <br>		<br>		<?php echo JText::_('SECURITY IMAGES DESCRIPTION') ?> <?php echo $copyright; ?>		</td>	</tr></table><br /><form	action="index2.php" method="post" name="adminForm"><?php	echo "<img alt='hncaptcha' src='".JURI :: root()."index.php?option=com_securityimages&task=displayCaptchaByPlugin&plugin=calculator&version=1.0' /> ";	?> <br /><br /><font size="1"><?php echo JText::_('SECURITY IMAGES PREVIEWING2') ?><br />	<?php echo JText::_('SECURITY IMAGES PREVIEWING3') ?></font> <br />	<?php	jimport('joomla.html.pane');	$jPaneTabs =& JPane::getInstance('sliders');	$jPaneTabs->startPane("Security_Images");	$jPaneTabs->startPanel("Calculator-plugin", "Calculator-page");	?><table width="100%" border="0" cellpadding="4" cellspacing="2"	class="adminForm">	<?php	echo displayInputBoxChoice('SI CALC FIRST NUMBER MIN S', 'SI CALC FIRST NUMBER MIN L', 'si_calculator_firstNumberMin', $si_calculator_firstNumberMin);	echo displayInputBoxChoice('SI CALC FIRST NUMBER MAX S', 'SI CALC FIRST NUMBER MAX L', 'si_calculator_firstNumberMax', $si_calculator_firstNumberMax);	echo displayInputBoxChoice('SI CALC SECOND NUMBER MIN S', 'SI CALC SECOND NUMBER MIN L', 'si_calculator_secondNumberMin', $si_calculator_secondNumberMin);	echo displayInputBoxChoice('SI CALC SECOND NUMBER MAX S', 'SI CALC SECOND NUMBER MAX L', 'si_calculator_secondNumberMax', $si_calculator_secondNumberMax);	echo displayInputBoxChoice('SI CALC INTERNAL SESSION NAME S', 'SI CALC INTERNAL SESSION NAME L', 'si_calculator_phpSessionInternalName', $si_calculator_phpSessionInternalName);	echo displayInputBoxChoice('SI CALC SECRET KEY S', 'SI CALC SECRET KEY L', 'si_calculator_secretKey', $si_calculator_secretKey);	echo displayInputBoxChoice('SI CALC RGB MIN S', 'SI CALC RGB MIN L', 'si_calculator_RGBmin', $si_calculator_RGBmin);	echo displayInputBoxChoice('SI CALC RGB MAX S', 'SI CALC RGB MAX L', 'si_calculator_RGBmax', $si_calculator_RGBmax);	echo displayInputBoxChoice('SI CALC BKG RGB MIN S', 'SI CALC BKG RGB MIN L', 'si_calculator_BKG_RGBmin', $si_calculator_BKG_RGBmin);	echo displayInputBoxChoice('SI CALC BKG RGB MAX S', 'SI CALC BKG RGB MAX L', 'si_calculator_BKG_RGBmax', $si_calculator_BKG_RGBmax);	echo displayInputBoxChoice('SI CALC X SIZE S', 'SI CALC X SIZE L', 'si_calculator_xSize', $si_calculator_xSize);	echo displayInputBoxChoice('SI CALC Y SIZE S', 'SI CALC Y SIZE L', 'si_calculator_ySize', $si_calculator_ySize);	echo displayInputBoxChoice('SI CALC FONT SIZE S', 'SI CALC FONT SIZE L', 'si_calculator_fontSize', $si_calculator_fontSize);	echo displayInputBoxChoice('SI CALC USE RANDOM BKG S', 'SI CALC USE RANDOM BKG L', 'si_calculator_useRandomBackground', $si_calculator_useRandomBackground);	?>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SI CALC OUPUT S') ?></strong></td>		<td align="left" valign="top"><?php		$soutput[] = JHTML::_('select.option', 'jpg', 'jpg');		$soutput[] = JHTML::_('select.option', 'png', 'png');		$soutput[] = JHTML::_('select.option', 'gif', 'gif');		$_output = JHTML::_('select.genericlist',$soutput, 'si_calculator_securityImagesoutput', 'class="inputbox" size="3"', 'value', 'text', $si_calculator_securityImagesoutput);		echo $_output;		?></td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SI CALC OUPUT L') ?></td>	</tr></table>		<?php		$jPaneTabs->endPane();		$jPaneTabs->endPanel();		?> <input type="hidden" name="option" value="<?php echo $option; ?>"><!-- <input type="hidden" name="act" value="<php echo $act; >"> --> <input	type="hidden" name="task" value=""> <input type="hidden"	name="boxchecked" value="0"></form>		<?php}/** * * @authors Walter Cedric */function saveConfig($option, $si_calculator_firstNumberMin, $si_calculator_firstNumberMax, $si_calculator_secondNumberMin, $si_calculator_secondNumberMax, $si_calculator_phpSessionInternalName, $si_calculator_secretKey, $si_calculator_securityImagesoutput, $si_calculator_RGBmin, $si_calculator_RGBmax, $si_calculator_xSize, $si_calculator_ySize, $si_calculator_fontSize, $si_calculator_useRandomBackground, $si_calculator_BKG_RGBmin, $si_calculator_BKG_RGBmax){  global $mainframe;  //You are  not allowed to modify this copyright, but You can add your version number and links  $securityImagesVersion = "SecurityImage calculator 1.0";  $securityImagesLink = "<a href='http://www.waltercedric.com' target='_blank'>" . $securityImagesVersion . "</a>";  $pluginName = "calculator";  $pluginVersion = "1.0";  $configfile = JPATH_SITE . DS.'administrator'.DS.'components'.DS.'com_securityimages'.DS.'pluginsA'.DS.$pluginName.DS.$pluginVersion.DS.'config.php';  @ chmod($configfile, 0766);  $permission = is_writable($configfile);  $mosmsg = "Config file " . $configfile . " is not writeable!";  if (!$permission)  {    $mainframe->redirect("index2.php?option=$option&act=config", $mosmsg);    break;  }  $config = "<?php\n";    $config .= "// no direct access\n";  $config .= "defined('_JEXEC') or die( 'Restricted access' );\n";  $config .= "\n";  //$config .= getCopyright();  $config .= "\n";  $config .= "\$si_calculator_firstNumberMin = \"$si_calculator_firstNumberMin\";\n";  $config .= "\$si_calculator_firstNumberMax = \"$si_calculator_firstNumberMax\";\n";  $config .= "\$si_calculator_secondNumberMin = \"$si_calculator_secondNumberMin\";\n";  $config .= "\$si_calculator_secondNumberMax = \"$si_calculator_secondNumberMax\";\n";  $config .= "\$si_calculator_phpSessionInternalName = \"$si_calculator_phpSessionInternalName\";\n";  $config .= "\$si_calculator_secretKey = \"$si_calculator_secretKey\";\n";  $config .= "\$si_calculator_securityImagesoutput = \"$si_calculator_securityImagesoutput\";\n";  $config .= "\$si_calculator_RGBmin = \"$si_calculator_RGBmin\";\n";  $config .= "\$si_calculator_RGBmax = \"$si_calculator_RGBmax\";\n";  $config .= "\$si_calculator_BKG_RGBmin = \"$si_calculator_BKG_RGBmin\";\n";  $config .= "\$si_calculator_BKG_RGBmax = \"$si_calculator_BKG_RGBmax\";\n";  $config .= "\$si_calculator_xSize = \"$si_calculator_xSize\";\n";  $config .= "\$si_calculator_ySize = \"$si_calculator_ySize\";\n";  $config .= "\$si_calculator_fontSize = \"$si_calculator_fontSize\";\n";  $config .= "\$si_calculator_useRandomBackground = \"$si_calculator_useRandomBackground\";\n";  $config .= "//You are  not allowed to modify this copyright, but You can add your version number and links\n";  $config .= "\$securityImagesVersion = \"$securityImagesVersion\";\n";  $config .= "\$securityImagesLink = \"$securityImagesLink\";\n";  $config .= "?>";  $mosmsg = JText::_('CONFIG_OPEN');  if ($fp = fopen("$configfile", "w"))  {    fputs($fp, $config, strlen($config));    fclose($fp);    $mosmsg = JText::_('CONFIG_OPEN_CLOSED');  }  $mainframe->redirect("index2.php?option=$option&task=settings", JText::_('CONFIG_SAVED') . $configfile);}?>