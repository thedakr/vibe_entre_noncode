<?php/** **************************************************************** * This file is part of SecurityImages for Joomla!. * * SecurityImages is free software: you can redistribute it and/or modify * it under the terms of the GNU General Public License as published by * the Free Software Foundation, either version 3 of the License, or * any later version. * Foobar is distributed in the hope that it will be useful, * but WITHOUT ANY WARRANTY; without even the implied warranty of * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the * GNU General Public License for more details. * * You should have received a copy of the GNU General Public License * along with Foobar.  If not, see <http://www.gnu.org/licenses/>. * * @package		SecurityImages * @copyright	Copyright (C) 2004 - 2008 Cédric Walter. All rights reserved. *******************************************************************/defined( '_JEXEC' ) or die( 'Restricted access' );require_once (JPATH_SITE .DS.'administrator'.DS.'components'.DS.'com_securityimages'.DS.'pluginsA'.DS.'hncaptcha'.DS.'1.0'.DS.'utils.php');jimport('joomla.html.pane');function savePluginSettings($option) {  $params_request = array (			'secretstring',			'site_tags0',			'site_tags1',			'tag_pos',			'watermarkAntiFreePornAttack',			'securityimages_fontsarray',			'securityimages_usegrille',			'textLength',			'securityimages_userandomtextlength',			'securityimages_randomtextlengthmin',			'securityimages_randomtextlengthmax',			'securityimages_textRgbMin',			'securityimages_textRgbMax',			'useRandomSize',			'textFontSizeDefualt',			'textFontSizeMin',			'textFontSizeMax',			'useRandomFont',			'securityimages_textUseExtendedCharacterSet',			'alignementStrategy',			'useRandomTextAngle',			'textAngleMin',			'textAngleMax',			'cleanupTable',			'securityImagesLogActive',			'securityImagesLogAll',			'securityImagesNotifyAdmin',			'securityImagesLogSize',			'securityImagesAdminEmail',			'securityImagesoutput',			'securityImagesMaxRetry',			'securityImagesVersion',			'securityImagesVersion',			'securityImagesLink'			);			foreach ($params_request as $val) {			  $$val = JRequest::getVar( $val, '');			}			saveConfig($option, $site_tags0, $site_tags1,			$tag_pos, $watermarkAntiFreePornAttack, $securityimages_fontsarray,			$userSelectionBigBackground, $userSelectionSmallBackground,			$securityimages_usegrille, $textLength, $securityimages_userandomtextlength,			$securityimages_randomtextlengthmin, $securityimages_randomtextlengthmax,			$securityimages_textRgbMin, $securityimages_textRgbMax, $useRandomSize,			$textFontSizeDefualt, $textFontSizeMin, $textFontSizeMax, $useRandomFont,			$securityimages_textUseExtendedCharacterSet, $alignementStrategy,			$useRandomTextAngle, $textAngleMin, $textAngleMax, $cleanupTable,			$securityImagesLogActive, $securityImagesLogAll, $securityImagesNotifyAdmin,			$securityImagesLogSize, $securityImagesAdminEmail, $securityImagesoutput,			$securityImagesMaxRetry, $securityImagesVersion, $securityImagesLink,			$secretstring);}function showConfig($option) {  global $securityImagesVersion, $securityImagesLink;  $database = & JFactory::getDBO();  $copyright = "<p></br>" . "" . "</br>" . "" . "</br></br></br>" . "<font class='smalldark'><b>" . $securityImagesVersion . "</b> - Copyright 2005 by Walter Cedric - " . $securityImagesLink . "</font></p>";  require_once (JPATH_SITE .DS.'administrator'.DS.'components'.DS.'com_securityimages'.DS.'pluginsA'.DS.'watercap'.DS.'1.0'.DS.'config.php');  ?><script language="javascript" type="text/javascript">    function submitbutton(pressbutton) {      var form = document.adminForm;      if (pressbutton == 'cancel') {        submitform( pressbutton );        return;      }        submitform( pressbutton );    }        var previewWindow = null;	function openPreviewWindow(){		var url ="<?php	global $securityImagesPlugins, $securityImagesPluginsVersion;	echo JPATH_SITE.DS.'components'.DS.'com_securityimages'.DS.'plugins'.DS.$securityImagesPlugins.DS.$securityImagesPluginsVersion.DS.'imageGenerator.php';?>		if ((!previewWindow) || (previewWindow)) {			previewWindow = this.open(url, "", "dependent=yes,top=140,left=140,toolbar=no,menubar=no,status=no,location=no,scrollbars=yes,resizable=yes,width=230,height=35");		}		else {			previewWindow.focus()		}    }    </script><table cellpadding="0" cellspacing="0" border="0">	<tr>		<td><img			src=<?php echo JURI :: root()."/administrator/components/com_securityimages/logo/com_securityimages.png" ?>>		</td>		<td><b><?php echo JText::_('SECURITY IMAGES ABOUT TITLE') ?></b> <br>		<br>		<?php echo JText::_('SECURITY IMAGES DESCRIPTION') ?> <?php echo $copyright; ?>		</td>	</tr></table><br /><form	action="index2.php" method="post" name="adminForm"><?php	echo "<img alt='hncaptcha' src='".JURI :: root()."index.php?option=com_securityimages&task=displayCaptchaByPlugin&plugin=watercap&version=1.0' /> ";	?> <br /><br /><font size="1"><?php echo JText::_('SECURITY IMAGES PREVIEWING2') ?><br />	<?php echo JText::_('SECURITY IMAGES PREVIEWING3') ?></font> <br />	<?php	$jPaneTabs =& JPane::getInstance('sliders');	echo $jPaneTabs->startPane("Security_Images");	echo $jPaneTabs->startPanel("Watercap-Core", "Watercap-page");	?><table width="100%" border="0" cellpadding="4" cellspacing="2"	class="adminForm">	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES TEXT MAX RETRY S') ?></strong></td>		<td align="left" valign="top"><input type="text" size="4"			name="securityImagesMaxRetry"			value="<?php echo "$securityImagesMaxRetry"; ?>"></td>		<td align="left" valign="top"><?php echo JText::_('SECURITY IMAGES TEXT MAX RETRY L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES TEXT LENGTH S') ?></strong></td>		<td align="left" valign="top"><input type="text" size="2"			name="textLength" value="<?php echo "$textLength"; ?>"></td>		<td align="left" valign="top"><?php echo JText::_('SECURITY IMAGES TEXT LENGTH L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES TEXT USE RANDOM TEXT LENGTH S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist', 'securityimages_userandomtextlength', 'class="inputbox"', $securityimages_userandomtextlength ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES TEXT USE RANDOM TEXT LENGTH L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES TEXT USE RANDOM TEXT MIN S') ?></strong></td>		<td align="left" valign="top"><input type="text" size="2"			name="securityimages_randomtextlengthmin"			value="<?php echo "$securityimages_randomtextlengthmin"; ?>"></td>		<td align="left" valign="top"><?php echo JText::_('SECURITY IMAGES TEXT USE RANDOM TEXT MIN L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES TEXT USE RANDOM TEXT MAX S') ?></strong></td>		<td align="left" valign="top"><input type="text" size="2"			name="securityimages_randomtextlengthmax"			value="<?php echo "$securityimages_randomtextlengthmax"; ?>"></td>		<td align="left" valign="top"><?php echo JText::_('SECURITY IMAGES TEXT USE RANDOM TEXT MAX L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES TEXT RGB MIN S') ?></strong></td>		<td align="left" valign="top"><input type="text" size="3"			name="securityimages_textRgbMin"			value="<?php echo "$securityimages_textRgbMin"; ?>"></td>		<td align="left" valign="top"><?php echo JText::_('SECURITY IMAGES TEXT RGB MIN L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES TEXT RGB MAX S') ?></strong></td>		<td align="left" valign="top"><input type="text" size="3"			name="securityimages_textRgbMax"			value="<?php echo "$securityimages_textRgbMax"; ?>"></td>		<td align="left" valign="top"><?php echo JText::_('SECURITY IMAGES TEXT RGB MAX L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES TEXT EXTENDED CHARSET S') ?></strong></td>		<td align="left" valign="top"><?php echo JHTML::_('select.booleanlist', 'securityimages_textUseExtendedCharacterSet', 'class="inputbox"', $securityimages_textUseExtendedCharacterSet ); ?>		</td>		<td align="left" valign="top"><?php echo JText::_('SECURITY IMAGES TEXT EXTENDED CHARSET L') ?></td>	</tr></table><?php echo  $jPaneTabs->endPanel(); ?> <?php echo $jPaneTabs->startPanel("Hackers","Hackers"); ?><table width="100%" border="0" cellpadding="4" cellspacing="2"	class="adminForm">	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('HN SECRETSTRING') ?></strong></td>		<td align="left" valign="top"><input type="text" name="secretstring"			size="55" value="<?php echo "$secretstring"; ?>"></td>		<td align="left" valign="top"><?php echo JText::_('HN SECRETSTRING HELP') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('HN NOTICE HELP TITLE') ?></strong></td>		<td align="left" valign="top"><input type="text" name="site_tags0"			size="70" value="<?php echo "$site_tags[0]"; ?>"></td>		<td align="left" valign="top"><?php echo JText::_('HN NOTICE HELP') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong>&nbsp;</strong></td>		<td align="left" valign="top"><input type="text" name="site_tags1"			size="70" value="<?php echo "$site_tags[1]"; ?>"></td>		<td align="left" valign="top">&nbsp;</td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('HN NOTICE TITLE') ?></strong></td>		<td align="left" valign="top"><?php		$stag_pos = array ();		$stag_pos[] = JHTML::_('select.option','0', 'Top');		$stag_pos[] = JHTML::_('select.option','1', 'Bottom');		$stag_pos[] = JHTML::_('select.option', '2', 'Both');		$_tag_pos = JHTML::_('select.genericlist',$stag_pos, 'tag_pos', 'class="inputbox" size="3"', 'value', 'text', $tag_pos);		echo $_tag_pos;		?></td>		<td align="left" valign="top" width="50%">&nbsp;</td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong></strong></td>		<td align="left" valign="top"><?php  echo  JHTML::_('select.booleanlist','watermarkAntiFreePornAttack', 'class="inputbox"', $watermarkAntiFreePornAttack); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('HN ANTIFREEPORNATTACK') ?></td>	</tr></table><?php echo $jPaneTabs->endPanel(); ?> <?php echo  $jPaneTabs->startPanel(JText::_('SECURITY IMAGES FONTS TAB'),"Fonts-page"); ?><table width="100%" border="0" cellpadding="4" cellspacing="2"	class="adminForm">	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES FONTS CHOICE') ?></strong></td>		<td align="left" valign="top"><input type="text"			name="securityimages_fontsarray" size="70"			value="<?php echo "$securityimages_fontsarray"; ?>"></td>		<td align="left" valign="top"><?php echo JText::_('SECURITY IMAGES FONTS CHOICE HELP') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES FONT RANDOM SIZE S') ?></strong></td>		<td align="left" valign="top"><?php echo  JHTML::_('select.booleanlist', 'useRandomSize', 'class="inputbox"', $useRandomSize ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES FONT RANDOM SIZE L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES FONT SIZE DEFAULT S') ?></strong></td>		<td align="left" valign="top"><input type="text" size="2"			name="textFontSizeDefualt"			value="<?php echo "$textFontSizeDefualt"; ?>"></td>		<td align="left" valign="top"><?php echo JText::_('SECURITY IMAGES FONT SIZE DEFAULT L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES FONT SIZE MINIMUM S') ?></strong></td>		<td align="left" valign="top"><input type="text" size="2"			name="textFontSizeMin" value="<?php echo "$textFontSizeMin"; ?>"></td>		<td align="left" valign="top"><?php echo JText::_('SECURITY IMAGES FONT SIZE MINIMUM L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES FONTSIZE MAXIMUM S') ?></strong></td>		<td align="left" valign="top"><input type="text" size="2"			name="textFontSizeMax" value="<?php echo "$textFontSizeMax"; ?>"></td>		<td align="left" valign="top"><?php echo JText::_('SECURITY IMAGES FONT SIZE MAXIMUM L') ?></td>	</tr>	<tr align="center" valign="middle">		<td align="left" valign="top"><strong><?php echo JText::_('SECURITY IMAGES FONT RANDOM FONT S') ?></strong></td>		<td align="left" valign="top"><?php echo  JHTML::_('select.booleanlist', 'useRandomFont', 'class="inputbox"', $useRandomFont ); ?>		</td>		<td align="left" valign="top" width="50%"><?php echo JText::_('SECURITY IMAGES FONT RANDOM FONT L') ?></td>	</tr></table><?phpecho $jPaneTabs->endPane(); echo  $jPaneTabs->endPane(); ?> <input type="hidden" name="option" value="<?php echo $option; ?>"> <!-- <input type="hidden" name="act" value="<php echo $act; >"> --><input type="hidden" name="task" value=""> <input type="hidden"	name="boxchecked" value="0"></form><?php}/** * * @authors Walter Cedric */function saveConfig($option, $site_tags0, $site_tags1, $tag_pos,$watermarkAntiFreePornAttack, $securityimages_fontsarray, $selectedBigBackground,$selectedSmallBackground, $securityimages_usegrille, $textLength, $securityimages_userandomtextlength,$securityimages_randomtextlengthmin, $securityimages_randomtextlengthmax, $securityimages_textRgbMin,$securityimages_textRgbMax, $useRandomSize, $textFontSizeDefualt, $textFontSizeMin, $textFontSizeMax,$useRandomFont, $securityimages_textUseExtendedCharacterSet, $alignementStrategy, $useRandomTextAngle,$textAngleMin, $textAngleMax, $cleanupTable, $securityImagesLogActive, $securityImagesLogAll,$securityImagesNotifyAdmin, $securityImagesLogSize, $securityImagesAdminEmail, $securityImagesoutput,$securityImagesMaxRetry, $securityImagesVersion, $securityImagesLink, $secretstring) {  global $mainframe;  //You are  not allowed to modify this copyright, but You can add your version number and links  $securityImagesVersion = "SecurityImage core 1.1";  $securityImagesLink = "<a href='http://www.waltercedric.com' target='_blank'>" . $securityImagesVersion . "</a>";  $pluginName = "core";  $pluginVersion = "1.1";  $configfile = JPATH_SITE .DS.'administrator'.DS.'components'.DS.'com_securityimages'.DS.'pluginsA'.DS.'watercap'.DS.'1.0'.DS.'config.php';  @ chmod($configfile, 0766);  $permission = is_writable($configfile);  $mosmsg = "Config file " . $configfile . " is not writeable!";  if (!$permission) {    $mainframe->redirect("index2.php?option=$option&act=config", $mosmsg);    break;  }  $config = "<?php\n";  $config .= "// no direct access\n";  $config .= "defined('_JEXEC') or die( 'Restricted access' );\n";  $config .= "\n";    $config .= getWatercapCopyright();  $config .= "\n";  $config .= "\$site_tags[0] = \"$site_tags0\";\n";  $config .= "\$site_tags[1] = \"$site_tags1\";\n";  $config .= "\$tag_pos = \"$tag_pos\";\n";  $config .= "\$watermarkAntiFreePornAttack = \"$watermarkAntiFreePornAttack\";\n";  $config .= "\$pluginName = \"$pluginName\";\n";  $config .= "\$pluginVersion = \"$pluginVersion\";\n";  $config .= "\$selectedBigBackground = \"$selectedBigBackground\";\n";  $config .= "\$selectedSmallBackground = \"$selectedSmallBackground\";\n";  $config .= "\$securityimages_usegrille = \"$securityimages_usegrille\";\n";  $config .= "\$textLength = \"$textLength\";\n";  $config .= "\$securityimages_userandomtextlength = \"$securityimages_userandomtextlength\";\n";  $config .= "\$securityimages_randomtextlengthmin = \"$securityimages_randomtextlengthmin\";\n";  $config .= "\$securityimages_randomtextlengthmax = \"$securityimages_randomtextlengthmax\";\n";  $config .= "\$securityimages_textRgbMin = \"$securityimages_textRgbMin\";\n";  $config .= "\$securityimages_textRgbMax = \"$securityimages_textRgbMax\";\n";  $config .= "\$useRandomSize = \"$useRandomSize\";\n";  $config .= "\$textFontSizeDefualt = \"$textFontSizeDefualt\";\n";  $config .= "\$textFontSizeMin = \"$textFontSizeMin\";\n";  $config .= "\$textFontSizeMax = \"$textFontSizeMax\";\n";  $config .= "\$useRandomFont = \"$useRandomFont\";\n";  $config .= "\$securityimages_textUseExtendedCharacterSet = \"$securityimages_textUseExtendedCharacterSet\";\n";  $config .= "\$alignementStrategy = \"$alignementStrategy\";\n";  $config .= "\$securityimages_fontsarray = \"$securityimages_fontsarray\";\n";  $config .= "\$useRandomTextAngle = \"$useRandomTextAngle\";\n";  $config .= "\$textAngleMin = \"$textAngleMin\";\n";  $config .= "\$textAngleMax = \"$textAngleMax\";\n";  $config .= "\$cleanupTable = \"$cleanupTable\";\n";  $config .= "\$securityImagesLogAll = \"$securityImagesLogAll\";\n";  $config .= "\$securityImagesLogActive = \"$securityImagesLogActive\";\n";  $config .= "\$securityImagesNotifyAdmin = \"$securityImagesNotifyAdmin\";\n";  $config .= "\$securityImagesLogSize = \"$securityImagesLogSize\";\n";  $config .= "\$securityImagesAdminEmail = \"$securityImagesAdminEmail\";\n";  $config .= "\$securityImagesoutput = \"$securityImagesoutput\";\n";  $config .= "\$securityImagesMaxRetry = \"$securityImagesMaxRetry\";\n";  $config .= "\$secretstring = \"secretstring\";\n";  $config .= "\$chars = \"3-6\";\n";  $config .= "//You are  not allowed to modify this copyright, but You can add your version number and links\n";  $config .= "\$securityImagesVersion = \"$securityImagesVersion\";\n";  $config .= "\$securityImagesLink = \"$securityImagesLink\";\n";  $config .= "?>";  $mosmsg = JText::_('CONFIG_OPEN');  if ($fp = fopen("$configfile", "w"))  {    fputs($fp, $config, strlen($config));    fclose($fp);    $mosmsg = JText::_('CONFIG_OPEN_CLOSED');  }  $mainframe->redirect("index2.php?option=$option&task=settings", JText::_('CONFIG_SAVED') . $configfile);}/** * * @authors Walter Cedric */function getWatercapCopyright() {  $copyright = "";  $copyright .= "/************************************************************\n";  $copyright .= "*\n";  $copyright .= "*		SecurityImages plugin Watercap v1.0 Copyright 2007 Walter Cedric\n";  $copyright .= "*		www.waltercedric.com\n";  $copyright .= "*\n";  $copyright .= "*    This file is part of SecurityImages component for Joomla.\n";  $copyright .= "*\n";  $copyright .= "*    com_securityimages is free software; you can redistribute it and/or modify\n";  $copyright .= "*    it under the terms of the GNU General Public License as published by\n";  $copyright .= "*    the Free Software Foundation; either version 2 of the License, or\n";  $copyright .= "*    (at your option) any later version.\n";  $copyright .= "*\n";  $copyright .= "*    com_securityimages is distributed in the hope that it will be useful,\n";  $copyright .= "*    but WITHOUT ANY WARRANTY; without even the implied warranty of\n";  $copyright .= "*    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n";  $copyright .= "*    GNU General Public License for more details.\n";  $copyright .= "*\n";  $copyright .= "*    You should have received a copy of the GNU General Public License\n";  $copyright .= "*    along with com_securityimages; if not, write to the Free Software\n";  $copyright .= "*    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n";  $copyright .= "*\n";  $copyright .= "*\n";  $copyright .= "\************************************************************/\n";  return  $copyright;}?>